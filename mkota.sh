#!/bin/bash
echo -n {\"datetime\": `cat $(dirname $1)/ota_metadata | cut -d "=" --output-delimiter "," -f 1,2 | awk -F, -v findex=1 -v value=post-timestamp '$findex == value {print}' | cut -d, -f 2`,\"filename\": \"`basename $1`\",\"id\": \"`sha256sum $1 | awk '{ print $1 }'`\",\"romtype\": \"official\",\"size\": `stat -c%s $1`,\"url\": \"https://github.com/Stellar-Weeb/OTA/releases/download/`cat $(dirname $1)/ota_metadata | cut -d "=" --output-delimiter "," -f 1,2 | awk -F, -v findex=1 -v value=pre-device '$findex == value {print}' | cut -d, -f 2`-S1.1/`basename $1`\",\"version\": \"S1.1\"}
